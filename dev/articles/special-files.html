<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="testthat">
<title>Special files • testthat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Special files">
<meta property="og:description" content="testthat">
<meta property="og:image" content="https://testthat.r-lib.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="testthat.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">testthat</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/custom-expectation.html">Custom expectations</a>
    <a class="dropdown-item" href="../articles/parallel.html">Running tests in parallel</a>
    <a class="dropdown-item" href="../articles/skipping.html">Skipping tests</a>
    <a class="dropdown-item" href="../articles/snapshotting.html">Snapshot tests</a>
    <a class="dropdown-item" href="../articles/special-files.html">Special files</a>
    <a class="dropdown-item" href="../articles/test-fixtures.html">Test fixtures</a>
    <a class="dropdown-item" href="../articles/third-edition.html">testthat 3e</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2023/10/testthat-3-2-0/">Version 3.2.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/10/testthat-3-1/">Version 3.1.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/10/testthat-3-0-0/">Version 3.0.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/11/testthat-2-3-0/">Version 2.3.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/04/testthat-2-1-0/">Version 2.1.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2017/12/testthat-2-0-0/">Version 2.0.0</a>
    <a class="external-link dropdown-item" href="https://blog.rstudio.com/2016/04/29/testthat-1-0-0/">Version 1.0.0</a>
    <a class="external-link dropdown-item" href="https://blog.rstudio.com/2015/05/29/testthat-0-10-0/">Version 0.10.0</a>
    <a class="external-link dropdown-item" href="https://blog.rstudio.com/2014/09/23/testthat-0-9/">Version 0.9.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/testthat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Special files</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/testthat/blob/HEAD/vignettes/special-files.Rmd" class="external-link"><code>vignettes/special-files.Rmd</code></a></small>
      <div class="d-none name"><code>special-files.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the various special files that testthat
understands: test, helper, setup/teardown, snapshot, and everything
else.</p>
<div class="section level2">
<h2 id="test-files">Test files<a class="anchor" aria-label="anchor" href="#test-files"></a>
</h2>
<p>These are the bread and butter of testthat. Test files live in
<code>tests/testthat/</code>, start with either <code>test-</code> or
<code>test_</code>, and end with <code>.r</code> or <code>.R</code>. We
recommend organising your test files so that there’s a one-to-one
correspondence between the files in <code>R/</code> and the files in
<code>tests/testthat/</code> so that (e.g.) <code>R/myfile.R</code> has
a matching <code>tests/testthat/test-myfile.R</code>. This
correspondence is maintained by functions like
<code><a href="https://usethis.r-lib.org/reference/use_r.html" class="external-link">usethis::use_r()</a></code> and <code><a href="https://usethis.r-lib.org/reference/use_r.html" class="external-link">usethis::use_test()</a></code> and
is taken advantage of by functions like
<code>devtools::test_active_file()</code> and
<code>devtools::test_coverage_active_file()</code>.</p>
<p>Test files are executed in alphabetical order, but you should strive
to avoid dependencies between test files. In principle, you should be
able to be run your test files in any order or even at the same
time.</p>
</div>
<div class="section level2">
<h2 id="helper-files">Helper files<a class="anchor" aria-label="anchor" href="#helper-files"></a>
</h2>
<p>Helper files live in <code>tests/testthat/</code>, start with
<code>helper</code>, and end with <code>.r</code> or <code>.R</code>.
They are sourced by <code>devtools::load_all()</code> (so they’re
available interactively when developing your packages) and by
<code><a href="../reference/test_package.html">test_check()</a></code> and friends (so that they’re available no
matter how your tests are executed).</p>
<p>Helper files are a useful place for functions that you’ve extracted
from repeated code in your tests, whether that be test fixtures
(<code><a href="../articles/test-fixtures.html">vignette("test-fixtures")</a></code>), custom expectations
(<code>vignette("custom-expectations")</code>), or skip helpers
(<code><a href="../articles/skipping.html">vignette("skipping")</a></code>).</p>
</div>
<div class="section level2">
<h2 id="setup-files">Setup files<a class="anchor" aria-label="anchor" href="#setup-files"></a>
</h2>
<p>Setup files live in <code>tests/testthat/</code>, start with
<code>setup</code>, and end with <code>.r</code> or <code>.R</code>.
Typically there is only one setup file which, by convention, is
<code>tests/testthat/setup.R</code>. Setup files are sourced by
<code><a href="../reference/test_package.html">test_check()</a></code> and friends (so that they’re available no
matter how your tests are executed), but they are <em>not</em> sourced
by <code>devtools::load_all()</code>.</p>
<p>Setup files are good place to put truly global test setup that would
be impractical to build into every single test and that might be
tailored for test execution in non-interactive or remote environments.
Examples:</p>
<ul>
<li>Turning off behaviour aimed at an interactive user, such as
messaging or writing to the clipboard.</li>
<li>Setting up a cache folder.</li>
</ul>
<p>If any of your setup should be reversed after test execution (i.e. it
needs to be torn down), we recommend maintaining that teardown code
alongside the setup code, in <code>setup.R</code>, because this makes it
easier to ensure they stay in sync. The artificial environment
<code><a href="../reference/teardown_env.html">teardown_env()</a></code> exists as a magical handle to use in
<code><a href="https://withr.r-lib.org/reference/defer.html" class="external-link">withr::defer()</a></code> and <code>withr::local_*()</code>. A legacy
approach (which still works, but is no longer recommended) is to put
teardown code in <code>tests/testthat/teardown.R</code>.</p>
<p>Here’s a <code>setup.R</code> example from the reprex package, where
we turn off clipboard and HTML preview functionality during testing:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>reprex.clipboard <span class="op">=</span> <span class="cn">FALSE</span>, reprex.html_preview <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/defer.html" class="external-link">defer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>, <span class="fu"><a href="../reference/teardown_env.html">teardown_env</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Since we are just modifying options here, we can be even more concise
and use the pre-built function <code><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">withr::local_options()</a></code> and
pass <code><a href="../reference/teardown_env.html">teardown_env()</a></code> as the <code>.local_envir</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">local_options</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>reprex.clipboard <span class="op">=</span> <span class="cn">FALSE</span>, reprex.html_preview <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  .local_envir <span class="op">=</span> <span class="fu"><a href="../reference/teardown_env.html">teardown_env</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="teardown-files">Teardown files<a class="anchor" aria-label="anchor" href="#teardown-files"></a>
</h3>
<p>Teardown files live in <code>tests/testhat/</code>, start with
<code>teardown</code> and end with <code>.r</code> or <code>.R</code>.
They are executed after the tests are run, but we no longer recommend
using them as it’s easier to check that you clean up every mess that you
make if you interleave setup and tear down code as described above.</p>
</div>
</div>
<div class="section level2">
<h2 id="snapshot-files">Snapshot files<a class="anchor" aria-label="anchor" href="#snapshot-files"></a>
</h2>
<p>Snapshot files live in <code>tests/testthat/_snaps/</code>. Snapshot
file are named automatically based on the name of the test file so that
<code>tests/testthat/test-one.R</code> will generated
<code>tests/testthat/_snaps/one.md</code>. Learn more about snapshot
tests in <code><a href="../articles/snapshotting.html">vignette("snapshotting")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="other-files-and-folders">Other files and folders<a class="anchor" aria-label="anchor" href="#other-files-and-folders"></a>
</h2>
<p>Other files and folders in <code>tests/testthat/</code> are ignored
by testthat, making them a good place to store persistent test data.
Since the precise location of the <code>test/testthat/</code> directory
varies slightly depending on how you’re running the test, we recommend
creating paths to these files and directories using
<code><a href="../reference/test_path.html">test_path()</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
